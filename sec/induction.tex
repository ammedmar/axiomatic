% !TEX root = ../axiomatic.tex

\subsection{Induction step}

\begin{notation}
	For $U \in \P_{n-i}^n$ we write $u \notin U$ if $u \in \{0, \dots, n\} \setminus U$. If $u \notin U$ define $u.U = \{u\} \union U \in \P_{n-i+1}(n)$ and if $u \in U$ define $U \setminus u = U \setminus \{u\} \in \P_{n-i-1}(n)$.
\end{notation}

\anibal{absorve the following lemma into the proof of the next one, the only place where it's used.}

\begin{lemma} \label{l:boundary triangle}
	Let $\triangle$ be a free non-degenerate cup-$i$ construction.
	If for some $i < n$ there is $\xi \colon \P_{n-i}^n \to \F$ such that
	\[
	\triangle_i [n]\ =\! \sum_{\P_{n-i}^n} {U^{\xi}} \ot {U^{\barxi}}
	\]
	then
	\begin{align*}
	\label{equation: boundary of triangle}
	\bd \triangle_i [n]\ = &
	\sum_{\P_{n-i}^n} \left( \, \sum_{u \in U^\barxi} u.U^\xi \ot U^\barxi \ +
	\sum_{u \in U^\xi} U^\xi \ot u.U^\barxi \right) \\ + &
	\sum_{\P_{n-i}^n} \sum_{x \notin U} \left( x.U^\xi \ot U^\barxi \ +\ U^\xi \ot {x.U^\barxi} \right).
	\end{align*}
\end{lemma}

\anibal{where is the proof? It is immediate from the definition of $\bd$ in $\cP$}

\begin{lemma}
	Let $\triangle$ be a free and non-degenerate cup-$i$ construction and $i,n \in \N$ with $i \leq n-2$.
	If there exists a function $\xi \colon \P_{n-i}^n \to \F$ such that
	\[
	\triangle_i [n]\ =\! \sum_{\P_{n-i}^n} {U^{\xi}} \ot {U^{\barxi}}
	\]
	and either
	\[
	\triangle_i [n-1] = \Delta_i [n-1]
	\quad \text{or} \quad
	\triangle_i [n-1] = T\Delta_i [n-1],
	\]
	then $\xi$ is constant, i.e.,
	\[
	\triangle_i [n] = \Delta_i [n]
	\quad \text{or} \quad
	\triangle_i [n] = T \Delta_i [n].
	\]
\end{lemma}

\iffalse
\begin{proof}
	Let us assume $\triangle_i [n-1] = \Delta_i [n-1] = \sum_{\P_{n-1-i}^{n-1}} U^0 \ot U^1$.
	The other case is done analogously.

	By \cref{l:boundary triangle} we have
	\begin{align*}
	\partial \triangle_i [n]\ & =\! \sum_{\P_{n-i}^n} \left(\sum_{u \notin U} {u.U^\xi} \ot {U^\barxi} +
	\sum_{u \notin U} {U^\xi} \ot {u.U^\barxi} \right) \\ & +\!
	\sum_{\P_{n-i}^n} \left(\sum_{u \in U^\barxi} {u.U^\xi} \ot {U^\barxi} +
	\sum_{u \in U^{\xi}} {U^\xi} \ot {u.U^\barxi} \right).
	\end{align*}
	Adding $\triangle_i \bd \, [n]$ to it and using identity \eqref{e:triangle of boundary} we deduce that $(1+T) \triangle_{i-1} [n] = \bd \triangle_i [n] + \triangle_i \bd \, [n]$ is equal to
	\begin{align}
	\label{e:top} & \sum_{\P_{n-i}^n} \left(\sum_{u \notin U} u.U^\xi \ot U^\barxi +
	\sum_{u \notin U} U^\xi \ot u.U^\barxi \right) \\ +\
	\label{e:bottom} (1+T) & \sum_{\substack{\P_{n-i}^n \\ \xi(U) \neq 0}} \left(\sum_{u \in U^1} {u.U^0} \ot {U^1} +
	\sum_{u \in U^0} {U^0} \ot {u.U^1} \right).
	\end{align}
	We will use Lemma \ref{l:condition to be in the kernel of sxs} to show that \eqref{e:top}, the first sum above, is in the kernel $K^{(j)}$ of $\cP(\sigma_j) \ot \cP(\sigma_j)$ for every codegeneracy $\sigma_j \colon [n] \to [n-1]$.
	Consider $U \in \P_{n-i}^n$.
	If $\{j, j+1\} \cap U = \emptyset$ then $u.U^\xi \ot U^\barxi \in K^{(j)}$ and $U^\xi \ot u.U^\barxi \in K^{(j)}$ for every $u \notin U$.
	If $\{j, j+1\} \cap U = \{j, j+1\}$ then the same conclusion follows from the fact that $\ind_U(j) = \ind_U(j+1)$.
	If $\{j, j+1\} \cap U = \{j\}$ then $u.U^\xi \ot U^\barxi \in K^{(j)}$ and $U^\xi \ot u.U^\barxi \in K^{(j)}$ for every $u \notin U$ with $u \neq j+1$.
	Furthermore, if $j \in U^\xi$ then $(j+1).U^\xi \ot U^\barxi \in K^{(j)}$ and $U^\xi \ot (j+1).U^\barxi \notin K^{(j)}$.
	An analogous statement holds if $j \in U^\barxi$ and a similar analysis applies to the case $\{j, j+1\} \cap U = \{j+1\}$.
	We will show that the basis elements in \eqref{e:top} that are not in $K^{(j)}$ cancel in pairs after the application of $\cP(\sigma_j) \ot \cP(\sigma_j)$.
	Let $\Gamma_j^\xi \subseteq \P_{n-i}^n$ consists of elements $U$ with $\{j, j+1\} \cap U = \{j\}$ and $j \in U^\xi$.
	Let $\Gamma_{j+1}^\xi$, $\Gamma_j^\barxi$, and $\Gamma_{j+1}^\barxi$ be defined analogously.
	The claim follows from the existence of the bijections $\Gamma_{j}^\xi \cong \Gamma_{j+1}^\xi$ and $\Gamma_{j}^\barxi \cong \Gamma_{j+1}^\barxi$ defined by the assignments $U \mapsto (j+1).\big( U \setminus \{j\} \big)$ and $U \mapsto j.\big( U \setminus \{j+1\} \big)$, since two summands related by one of these bijections are sent to the same element by $\cP(\sigma_j) \ot \cP(\sigma_j)$.

	We will impose conditions on \eqref{e:bottom} following an analysis similar to the one just given.
	Notice that $(1+T)$ commutes with $\cP(\sigma_j) \ot \cP(\sigma_j)$ and that the only basis elements in \eqref{e:bottom} not in $K^{(j)}$ are associated to pairs $(U, u)$ with $\xi(U) \neq 0$ and $u = j$ or $ u = j+1$.
	Let $\Lambda_{j}^0$ be the subset of $\{U \in \P_{n-i}^n \mid \xi(U) \neq 0\}$ consisting of sets $U$ with $j \in U^0$ and $j+1 \notin U$.
	We define $\Lambda_{j}^1$, $\Lambda_{j+1}^0$, and $\Lambda_{j+1}^1$ analogously.
	The set $\Lambda_{j \wedge j+1}$ is defined by the conditions $\xi(U) \neq 0$ and $j,j+1 \in U$.

	Observe that the sum
	\[
	\sum_{\Lambda_{j \wedge j+1}} \left( \sum_{u \in U^1} {u.U^0} \ot {U^1} +
	\sum_{u \in U^0} {U^0} \ot {u.U^1} \right)
	\]
	is in $K^{(j)}$ since, given that $\ind_U(j) = \ind_U(j+1)$, the only non-zero summands associated to $(U,j)$ and $(U,j+1)$ cancel each other.
	Therefore, applying $\cP(\sigma_j) \ot \cP(\sigma_j)$ to
	\[
	\sum_{\substack{\P_{n-i}^n \\ \xi(U) \neq 0}} \left(\sum_{u \in U^1} {u.U^0} \ot {U^1} +
	\sum_{u \in U^0} {U^0} \ot {u.U^1} \right)
	\]
	yields
	\begin{align*}
	&\sum_{\Lambda_{j}^0} U^0 \setminus \{j\} \ot {U^1} \ + \
	\sum_{\Lambda_{j}^1} U^0 \ot {U^1} \setminus \{j\} \\ + \
	&\sum_{\Lambda_{j+1}^0} U^0 \setminus \{j+1\} \ot {U^1} \ + \
	\sum_{\Lambda_{j+1}^1} U^0 \ot {U^1} \setminus \{j+1\}.
	\end{align*}
	which must be in the kernel of $(1+T)$.
	This implies the existence of an involution $\phi^{(j)}$ of $\Lambda = \Lambda^0_{j} \sqcup \Lambda^1_{j} \sqcup \Lambda^1_{j+1} \sqcup \Lambda^1_{j+1}$ defined by a choice of canceling pairs.
	By the freeness of $\Delta$ and since $i \leq n-2$, this involution has no fixed points.
	It follows that two elements $U$ and $U^\prime$ with $U \cap \{j, j+1\} = U^\prime \cap \{j, j+1\}$ cannot be related by $\phi^{(j)}$ since then $U = U^\prime$.
	Therefore, $\phi^{(j)}(U) = U^\prime$ if and only if $U^\prime = j.(U \setminus \{j+1\})$ or $U^\prime = (j+1).\big( U \setminus \{j+1\} \big)$.
	Recall that by definition $\xi(U) = \xi(U^\prime) \neq 0$.
	This analysis applies to any $j \in \{0, \dots, n\}$ and we introduce a relation in $\P_{n-i}^n$ writing $U \sim U^\prime$ if $U^\prime = j.(U \setminus \{j+1\})$ or $U^\prime = (j+1).\big( U \setminus \{j+1\} \big)$ for some $j$.
	By the previous analysis, if $U \sim U^\prime$ then $\xi(U) = \xi(U^\prime)$.
	The lemma now follows from observing that any two elements $V$ and $W$ in $\P_{n-i}^n$ are related by a sequence
	\[
	V \sim \dots \sim W,
	\]
	so $\xi \colon \P_{n-i}^n \to \F$ must be constant.
\end{proof}
\fi

\begin{lemma}
	Let $\triangle$ be irreducible and $i \leq n-2$.
	If $\triangle_i [n] = \Delta_i [n]$ or $\triangle_i [n] = T \Delta_i [n]$ then the following implications hold:
	\begin{alignat*}{2}
	&\boxed{\triangle_i [n-1] = \Delta_i [n-1] \hspace*{7pt}}\ &\Longrightarrow\
	&\boxed{\triangle_i [n] = \Delta_i [n] \hspace*{7pt}} \\
	&\boxed{\triangle_i [n-1] = T \Delta_i [n-1]}\ &\Longrightarrow\
	&\boxed{\triangle_i [n] = T \Delta_i [n]}
	\end{alignat*}
\end{lemma}

\iffalse
\begin{proof}
	We will establish the first of these implications using proof by contradiction.
	The second is proven analogously.
	Observe that using the assumptions we have
	\begin{align*}
	(1+T) \triangle_{i-1}[n] &=
	\bd T \Delta_i [n] + \Delta_i \bd \, [n] \\ &=
	T \bd \Delta_i [n] + \bd \Delta_i [n] + \bd \Delta_i [n] + \Delta_i \bd \, [n] \\ &=
	(1+T) \bd \Delta_i [n] + (1+T) \Delta_{i-1} [n] \\ &=
	(1+T) \Delta_i \bd \, [n] + (1+T) \Delta_{i-1} [n]
	\end{align*}
	Using \eqref{e:triangle of boundary} and the definition of $\Delta_{i-1} [n]$ we have
	\begin{align*}
	(1+T) \triangle_{i-1}[n] &=
	(1+T) \sum_{\P_{n-i}^n} \left( \,
	\sum_{u \in U^1} {u.U^0} \ot {U^1} \ +
	\sum_{u \in U^0} {U^0} \ot {u.U^1} \right) \\ &+
	(1+T) \sum_{\P_{n-i+1}^n} U^0 \ot U^1.
	\end{align*}
	By \cref{l:freeness recasted} there exists functions $\eta \colon \P_{n-i}^n \to \F$ and $\zeta \colon \P_{n-i+1}^n \to \F$ such that
	\begin{align*}
	\triangle_{i-1}[n] \ &=
	\sum_{\P_{n-i}^n} \left( \,
	\sum_{u \in U^\bareta} u.U^\eta \ot U^\bareta \ +
	\sum_{u \in U^\eta} U^\eta \ot u.U^\bareta \right) \\ &+
	\sum_{\P_{n-i+1}^n} U^\zeta \ot U^\barzeta.
	\end{align*}
	But this contradicts the irreducibility of $\triangle$.
\end{proof}
\fi

\begin{figure}
	\centering
	\begin{tikzpicture}[scale = .65]
	\draw (0,0)--(0,6);
	\draw (0,0)--(11,0);
	\draw (0,0)--(6,6);
	\draw (1,0)--(7,6);
	\draw (3,0)--(9,6);
	\draw (4,0)--(10,6);
	\draw[dashed] (5,0)--(11,6);

	\draw[dotted, shorten >=10pt,shorten <=10pt] (3,2)--(4,1);
	\draw[dotted, shorten >=10pt,shorten <=10pt] (5,4)--(6,3);
	\draw[dotted, shorten >=10pt,shorten <=10pt] (7,6)--(8,5);

	\fill (7,4) circle (0.1);
	\fill (8,4) circle (0.1);
	\fill (7,3) circle (0.1);
	\fill[white] (8,3) circle (0.1);
	\draw (8,3) circle (0.1);

	\node[above] at (7,4) {p};
	\node[above] at (8,4) {p};
	\node[above] at (7,3) {q};
	\node[above] at (8,3) {q};

	\draw[dotted, shorten >=10pt,shorten <=10pt] (7,2)--(8,1);
	\draw[dotted, shorten >=10pt,shorten <=10pt] (9,4)--(10,3);
	\draw[dotted, shorten >=10pt,shorten <=10pt] (11,6)--(12,5);

	\node[below] at (11,0) {$n$};
	\node[left] at (0,6) {$i$};
	\end{tikzpicture}
	\caption{Induction step \label{figure}}
\end{figure}

\newpage


\begin{lemma}
	Let $\triangle$ be a free non-degenerate cup-$i$ construction.
	Let $\big\{\p(i,n)\big\}_{i,n\in\N}$ and $\big\{\q(i,n)\big\}_{i,n \in \N}$ each be one of the following two families of propositions:
	\[
	\big\{ \triangle_i [n] = \Delta_ i [n] \big\}_{i,n\in\N}
	\quad \text{or} \quad
	\big\{ \triangle_i [n] = T \Delta_ i [n] \big\}_{i,n\in\N} \ .
	\]
	For all $i,n \in \N$ with $i < n-1$ the following implication holds:
	\[
	\boxed{\p(i+1,n) \wedge \p(i+1,n-1) \wedge \q(i,n-1)}\ \Longrightarrow\ \boxed{\q(i,n)}
	\]
\end{lemma}

\begin{proof}
	Let both $\big\{ \p(i,n) \big\}_{i,n\in\N}$ and $\big\{ \q(i,n) \big\}_{i,n\in\N}$ be the family $\big\{ \triangle_i [n] = \Delta_i [n] \big\}_{i,n \in \N}$.
	The other three combinations are treated analogously.

	From $\p(i+1,n)$ and $\p(i+1,n-1)$ we have
	\[
	\partial \triangle_{i+1} [n] + \triangle_{i+1} \partial [n] = \partial \Delta_{i+1} [n] + \Delta_{i+1} \partial [n]
	\]
	or, equivalently,
	\[
	(1+T) \triangle_{i} [n] = (1+T) \Delta_{i} [n]
	\]
	Lemma \ref{lemma: extra lemma} implies
	\begin{equation} \label{proposition: uniqueness: induction step: eq1}
	\Delta_{i} [n] \ = \!\!\! \sum_{U \in \P_{n-i}^n} d_{U^{\xi}} [n] \tensor d_{U^{\barxi}} [n]
	\end{equation}
	for some $\barxi,\, \xi \colon \P_{n-i}^n\to\{+,-\}$.
	To finish the proof we need to show $\xi(U) = -$ and $\barxi(U) = +$
	for each $U \in \P_{n-i}^n$.
	Therefore,
	\[
	(1+T)\,(\Delta_{i-1})_n =
	\partial_{n+i}\, (\Delta_{i})_n\ +\ (\Delta_{i})_{n-1}\, \partial_{n}
	\]
\end{proof}